Readme

### –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ env
```bash
cp -i .env.example .env 
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash 
make up
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash 
make down
```

### –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π

–Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –≤ phinx.php –æ–∫—Ä—É–∂–µ–Ω–∏–µ testing –ø–æ–¥ —Å–≤–æ–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–ª–∏ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –±–µ–∑ –¥–æ–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
./vendor/bin/phinx migrate -e testing
````

### –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∏–¥–µ—Ä–æ–≤

```bash
./vendor/bin/phinx seed:run -e testing
```

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
```bash 
docker exec -it ms-ticket-manager composer phinx-migrate-up
```
### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ seed
```bash 
docker exec -it ms-ticket-manager composer phinx-seed-up
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–æ—Ç–µ—Ä–µ–π

#### –ë–∞–∑–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è (3 –¥–Ω—è –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞–Ω)
```bash 
docker exec -it ms-ticket-manager php webman lottery-numbers:generate
```

#### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π (1-365)
```bash 
docker exec -it ms-ticket-manager php webman lottery-numbers:generate --days=7
```

#### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞–Ω
```bash 
docker exec -it ms-ticket-manager php webman lottery-numbers:generate --countries=RU
docker exec -it ms-ticket-manager php webman lottery-numbers:generate --countries=RU,UZ
```

#### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è (–¥–Ω–∏ + —Å—Ç—Ä–∞–Ω—ã)
```bash 
docker exec -it ms-ticket-manager php webman lottery-numbers:generate --days=30 --countries=RU,UZ
```

### –î–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –±–∏–ª–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É (—Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç Y-m-d)
```bash 
docker exec -it ms-ticket-manager php webman lottery-tickets:create 2025-04-05 2025-04-05
```

## –ö–æ–º–∞–Ω–¥—ã —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

### üìã –≠–∫—Å–ø–æ—Ä—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ—Ç–µ—Ä–µ–π
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ—Ç–µ—Ä–µ–π (–¥–∞—Ç–∞ —Ä–æ–∑—ã–≥—Ä—ã—à–∞ >= —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã) –≤ Kafka –¥–ª—è ms-draw-service.
```bash 
docker exec -it ms-ticket-manager php webman export_active_lotteries:run
```
- **–¢–æ–ø–∏–∫ Kafka**: `lottery_schedules_topic`
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: —Ç–æ–ª—å–∫–æ –ª–æ—Ç–µ—Ä–µ–∏ —Å `schedule_exported_at IS NULL`
- **–ü–æ–º–µ—Ç–∫–∞**: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `schedule_exported_at = now()` –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–º –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç

### üéüÔ∏è –≠–∫—Å–ø–æ—Ä—Ç –±–∏–ª–µ—Ç–æ–≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ª–æ—Ç–µ—Ä–µ–π

#### –≠–∫—Å–ø–æ—Ä—Ç –±–∏–ª–µ—Ç–æ–≤ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –ª–æ—Ç–µ—Ä–µ–∏ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø—Ä–∏–∑–æ–º
```bash 
docker exec -it ms-ticket-manager php webman export_tickets:daily_fixed --lottery-id=ID
```

#### –≠–∫—Å–ø–æ—Ä—Ç –±–∏–ª–µ—Ç–æ–≤ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –ª–æ—Ç–µ—Ä–µ–∏ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–∑–æ–º
```bash 
docker exec -it ms-ticket-manager php webman export_tickets:daily_dynamic --lottery-id=ID
```

#### –≠–∫—Å–ø–æ—Ä—Ç –±–∏–ª–µ—Ç–æ–≤ –¥–∂–µ–∫–ø–æ—Ç –ª–æ—Ç–µ—Ä–µ–∏
```bash 
docker exec -it ms-ticket-manager php webman export_tickets:jackpot --lottery-id=ID
```

#### –≠–∫—Å–ø–æ—Ä—Ç –±–∏–ª–µ—Ç–æ–≤ —Å—É–ø–µ—Ä—Ç—É—Ä –ª–æ—Ç–µ—Ä–µ–∏
```bash 
docker exec -it ms-ticket-manager php webman export_tickets:supertour --lottery-id=ID
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —ç–∫—Å–ø–æ—Ä—Ç–∞ –±–∏–ª–µ—Ç–æ–≤:**
- `--lottery-id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - ID –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ª–æ—Ç–µ—Ä–µ–∏, –∏–Ω–∞—á–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ **–≤—Å–µ—Ö** –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ—Ç–µ—Ä–µ–π —Ç–∏–ø–∞
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: —Ç–æ–ª—å–∫–æ –±–∏–ª–µ—Ç—ã —Å `tickets_exported_at IS NULL` (–Ω–µ—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
- **–ü–æ–º–µ—Ç–∫–∞**: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `tickets_exported_at = now()` –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Kafka
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: –ø–æ —á–∞–Ω–∫–∞–º (—Ä–∞–∑–º–µ—Ä –∏–∑ `USER_TICKETS_EXPORT_CHUNK_SIZE`)
- **–õ–∏–º–∏—Ç**: –º–∞–∫—Å–∏–º—É–º –±–∏–ª–µ—Ç–æ–≤ –∏–∑ `USER_TICKETS_EXPORT_MAX_TICKETS`
- **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**: –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ú–∞—Å—Å–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è `--lottery-id` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –ª–æ—Ç–µ—Ä–µ–∏ –¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞

### üèÜ –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –¥–ª—è –ª–æ—Ç–µ—Ä–µ–π —Å –∑–∞–≤–µ—Ä—à–∏–≤—à–∏–º–∏—Å—è –ø—Ä–æ–¥–∞–∂–∞–º–∏ –≤ ms-draw-service.
```bash 
docker exec -it ms-ticket-manager php webman export_lottery_winners_config:run [--lottery-id=ID]
```
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: 
  - `--lottery-id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ª–æ—Ç–µ—Ä–µ–∏
  - –ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –≤—Å–µ—Ö –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ª–æ—Ç–µ—Ä–µ–π
- **–£—Å–ª–æ–≤–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞**:
  - `is_active = true` (–∞–∫—Ç–∏–≤–Ω–∞—è –ª–æ—Ç–µ—Ä–µ—è)
  - `is_drawn = false` (–µ—â–µ –Ω–µ —Ä–∞–∑—ã–≥—Ä–∞–Ω–∞)
  - `calculated_winners_count IS NOT NULL` (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ)
  - `winners_config_exported_at IS NULL` (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –µ—â–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞)
- **–¢–æ–ø–∏–∫ Kafka**: `lottery_draw_config_topic`
- **–ü–æ–º–µ—Ç–∫–∞**: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `winners_config_exported_at = now()` –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É

### üì• –ò–º–ø–æ—Ä—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤
–ü–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–æ–∑—ã–≥—Ä—ã—à–∞ –æ—Ç ms-draw-service —á–µ—Ä–µ–∑ Kafka.
```bash 
docker exec -it ms-ticket-manager php webman import_winner_tickets:run
```
- **–ò—Å—Ç–æ—á–Ω–∏–∫**: Kafka –∫–æ–Ω—Å—å—é–º–µ—Ä
- **–¢–æ–ø–∏–∫**: `lottery_draw_results_topic`
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—É `winner_tickets`

## –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### üßÆ –†–∞—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –¥–ª—è –ª–æ—Ç–µ—Ä–µ–π —Å –∑–∞–≤–µ—Ä—à–∏–≤—à–∏–º–∏—Å—è –ø—Ä–æ–¥–∞–∂–∞–º–∏.
```bash 
docker exec -it ms-ticket-manager php webman calculate_lottery_winners:run [--lottery-id=ID]
```
- **–£—Å–ª–æ–≤–∏—è**: –ª–æ—Ç–µ—Ä–µ–∏ –≥–¥–µ `end_date <= now() - 2 minutes` –∏ `calculated_winners_count IS NULL`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–µ `calculated_winners_count`
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É





### –¢–µ—Å—Ç–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Å—å—é–º–µ—Ä–∞
```bash 
docker exec -it ms-ticket-manager php webman consume:run
```

### –¢–µ—Å—Ç–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ 
```bash 
docker exec -it ms-ticket-manager php webman TestCommand
```

#------------------–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞------------------#

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –∑–∞–ø—É—â–µ–Ω–∞ –æ–±—â–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è shared-infra:

```bash
cd ../shared-infra
docker-compose up -d
```

## –ó–∞–ø—É—Å–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone <url-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è> ms-ticket-manager
cd ms-ticket-manager
```

2. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ .env.example:

```bash
cp .env.example .env
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```bash
docker-compose up -d
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8084 (–∏–ª–∏ –ø–æ—Ä—Ç, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ .env)

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏–≤—è–∑–∞–Ω —á–µ—Ä–µ–∑ volumes –∫ docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É, –ø–æ—ç—Ç–æ–º—É –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ—Ç–ª–∞–¥–∫–∏.

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL `ms_ticket_manager` –∏–∑ –æ–±—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –æ–±—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (shared-infra).

–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤—Ä—É—á–Ω—É—é, –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:

```bash
docker exec -it nlu-postgres psql -U postgres -d postgres -c "SELECT create_database_if_not_exists('ms_ticket_manager');"
```

## Kafka

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å Kafka –∏–∑ –æ–±—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ —Ç–æ–ø–∏–∫–∞–º–∏:
- `daily_fixed_tickets_v1` - –±–∏–ª–µ—Ç—ã –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –ª–æ—Ç–µ—Ä–µ–∏ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø—Ä–∏–∑–æ–º
- `daily_dynamic_tickets_v1` - –±–∏–ª–µ—Ç—ã –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –ª–æ—Ç–µ—Ä–µ–∏ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–∑–æ–º
- `jackpot_tickets_v1` - –±–∏–ª–µ—Ç—ã –¥–∂–µ–∫–ø–æ—Ç –ª–æ—Ç–µ—Ä–µ–∏
- `supertour_tickets_v1` - –±–∏–ª–µ—Ç—ã —Å—É–ø–µ—Ä—Ç—É—Ä –ª–æ—Ç–µ—Ä–µ–∏
- `lottery_schedules_v1` - —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ—Ç–µ—Ä–µ–π
- `lottery_draw_results_v1` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (Background Processes)

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã:

### –ü—Ä–æ—Ü–µ—Å—Å—ã —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
- **ExportActiveLotteriesProcess** - —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –Ω–µ–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ—Ç–µ—Ä–µ–π –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- **ExportTicketsProcess** - —ç–∫—Å–ø–æ—Ä—Ç –Ω–µ–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ª–æ—Ç–µ—Ä–µ–π –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã  
- **ExportLotteryWinnersConfigProcess** - —ç–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –¥–ª—è –ª–æ—Ç–µ—Ä–µ–π —Å –∑–∞–≤–µ—Ä—à–∏–≤—à–∏–º–∏—Å—è –ø—Ä–æ–¥–∞–∂–∞–º–∏ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É

### –ü—Ä–æ—Ü–µ—Å—Å—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- **GenerateLotteryNumbersProcess** - –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–æ—Ç–µ—Ä–µ–π –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 00:00
- **AutoGenerateTicketsProcess** - –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –±–∏–ª–µ—Ç–æ–≤ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –ø—É–ª–∞

### –ü—Ä–æ—Ü–µ—Å—Å—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —Ä–∞—Å—á–µ—Ç–æ–≤
- **CloseBasketsOnTimeProcess** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –∏—Å—Ç–µ–∫—à–∏—Ö –∫–æ—Ä–∑–∏–Ω –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- **CalculateLotteryWinnersProcess** - —Ä–∞—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –¥–ª—è –∑–∞–∫—Ä—ã—Ç—ã—Ö –ª–æ—Ç–µ—Ä–µ–π –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É

–í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `runtime/logs/` –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç—Å–ª–µ–∂–µ–Ω—ã —á–µ—Ä–µ–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–∞–Ω–∞–ª—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

## –ö–æ–º–∞–Ω–¥—ã —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏ –∏–º–ø–æ—Ä—Ç–∞

### –ö–æ–º–∞–Ω–¥—ã —ç–∫—Å–ø–æ—Ä—Ç–∞ –±–∏–ª–µ—Ç–æ–≤

#### –≠–∫—Å–ø–æ—Ä—Ç –±–∏–ª–µ—Ç–æ–≤ –ø–æ —Ç–∏–ø–∞–º –ª–æ—Ç–µ—Ä–µ–π
```bash
# –≠–∫—Å–ø–æ—Ä—Ç –±–∏–ª–µ—Ç–æ–≤ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –ª–æ—Ç–µ—Ä–µ–∏ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø—Ä–∏–∑–æ–º
docker exec -it ms-ticket-manager php webman export_tickets:daily_fixed --lottery-id=ID

# –≠–∫—Å–ø–æ—Ä—Ç –±–∏–ª–µ—Ç–æ–≤ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –ª–æ—Ç–µ—Ä–µ–∏ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–∑–æ–º
docker exec -it ms-ticket-manager php webman export_tickets:daily_dynamic --lottery-id=ID

# –≠–∫—Å–ø–æ—Ä—Ç –±–∏–ª–µ—Ç–æ–≤ –¥–∂–µ–∫–ø–æ—Ç –ª–æ—Ç–µ—Ä–µ–∏
docker exec -it ms-ticket-manager php webman export_tickets:jackpot --lottery-id=ID

# –≠–∫—Å–ø–æ—Ä—Ç –±–∏–ª–µ—Ç–æ–≤ —Å—É–ø–µ—Ä—Ç—É—Ä –ª–æ—Ç–µ—Ä–µ–∏
docker exec -it ms-ticket-manager php webman export_tickets:supertour --lottery-id=ID
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç –±–∏–ª–µ—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ç–∏–ø–æ–≤ –ª–æ—Ç–µ—Ä–µ–π –≤ Kafka —Ç–æ–ø–∏–∫–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏.

#### –≠–∫—Å–ø–æ—Ä—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ª–æ—Ç–µ—Ä–µ–π
```bash
# –≠–∫—Å–ø–æ—Ä—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ—Ç–µ—Ä–µ–π
docker exec -it ms-ticket-manager php webman export_active_lotteries:run
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ—Ç–µ—Ä–µ–π –≤ —Ç–æ–ø–∏–∫ `lottery_schedules_v1` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏.

#### –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π
```bash
# –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ª–æ—Ç–µ—Ä–µ–∏
docker exec -it ms-ticket-manager php webman export_lottery_winners_config:run --lottery-id=123
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –≤ ms-draw-service —á–µ—Ä–µ–∑ Kafka –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞.

### –ö–æ–º–∞–Ω–¥—ã —Ä–∞—Å—á–µ—Ç–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π

```bash
# –†–∞—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –¥–ª—è –≤—Å–µ—Ö –∑–∞–∫—Ä—ã—Ç—ã—Ö –ª–æ—Ç–µ—Ä–µ–π
docker exec -it ms-ticket-manager php webman calculate_lottery_winners:run

# –†–∞—Å—á–µ—Ç –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ª–æ—Ç–µ—Ä–µ–∏
docker exec -it ms-ticket-manager php webman calculate_lottery_winners:run --lottery-id=123
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –¥–ª—è –ª–æ—Ç–µ—Ä–µ–π —Å –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –ø—Ä–æ–¥–∞–∂–∞–º–∏ (2+ –º–∏–Ω—É—Ç—ã –Ω–∞–∑–∞–¥). –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ `calculated_winners_count`.

### –ö–æ–º–∞–Ω–¥—ã –∏–º–ø–æ—Ä—Ç–∞

```bash
# –ò–º–ø–æ—Ä—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤
docker exec -it ms-ticket-manager php webman import_winner_tickets:run
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π –∏–∑ ms-draw-service, –æ–±–Ω–æ–≤–ª—è—è —Å—Ç–∞—Ç—É—Å –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤.

## –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–≤—É—Ö—ç—Ç–∞–ø–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

1. **–†–∞—Å—á–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
   - –ù–∞—Ö–æ–¥–∏—Ç –ª–æ—Ç–µ—Ä–µ–∏ —Å –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –ø—Ä–æ–¥–∞–∂–∞–º–∏ (2+ –º–∏–Ω—É—Ç—ã –Ω–∞–∑–∞–¥)
   - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ LeaderBoardService
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ø–æ–ª–µ `calculated_winners_count`

2. **–≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ Kafka —Ç–æ–ø–∏–∫ `lottery-draw-config`
   - ms-draw-service –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞

### Workflow
```
1. –õ–æ—Ç–µ—Ä–µ—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è (end_date –Ω–∞—Å—Ç—É–ø–∏–ª)
2. –ß–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π (–ø—Ä–æ—Ü–µ—Å—Å –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
3. –°—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞: —ç–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ Kafka (–ø—Ä–æ—Ü–µ—Å—Å –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
4. ms-draw-service –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–æ–≤–æ–¥–∏—Ç —Ä–æ–∑—ã–≥—Ä—ã—à
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Kafka
```json
{
  "event_type": "lottery_winners_config",        // –¢–∏–ø —Å–æ–±—ã—Ç–∏—è –¥–ª—è —Ä–æ—É—Ç–∏–Ω–≥–∞
  "lottery_id": 123,                            // ID –ª–æ—Ç–µ—Ä–µ–∏
  "lottery_type": "daily_dynamic",              // –¢–∏–ø –ª–æ—Ç–µ—Ä–µ–∏
  "winners_count": 7,                           // –ì–õ–ê–í–ù–û–ï: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤ –¥–ª—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞
  "total_participants": 87,                     // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
  "total_tickets_sold": 145,                    // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤
  "timestamp": "2024-01-15T10:30:00Z"          // –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏
}
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ
- ‚úÖ **–ü–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å** - –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç —Å —Ç–µ–º–∏ –∂–µ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ **–ê—É–¥–∏—Ç** - –µ—Å—Ç—å –∑–∞–ø–∏—Å—å –æ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∏—Å–∫–ª—é—á–µ–Ω—ã –æ—à–∏–±–∫–∏ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

## LeaderBoardService - –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏–∑–æ–≤

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–∞

LeaderBoardService –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ –ø—Ä–∏–∑–æ–≤ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–æ —Ö–∞—Ä–¥–∫–æ–¥–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–æ–≤.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
- **PrizeConfiguration** - —à–∞–±–ª–æ–Ω—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –ø—Ä–∏–∑–æ–≤ –¥–ª—è —Ç–∏–ø–æ–≤ –ª–æ—Ç–µ—Ä–µ–π
- **PrizeConfigurationPosition** - –¥–µ—Ç–∞–ª–∏ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–∑–æ–≤–æ–≥–æ –º–µ—Å—Ç–∞ (1-–µ, 2-–µ –º–µ—Å—Ç–æ –∏ —Ç.–¥.)
- **LotteryNumber** - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ª–æ—Ç–µ—Ä–µ–∏ —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### 2. –¢–∏–ø—ã –ø—Ä–∏–∑–æ–≤

**Money (–¥–µ–Ω–µ–∂–Ω—ã–µ):**
```php
prize_type = 'money'
prize_amount_rub = 1000  // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞ –≤ —Ä—É–±–ª—è—Ö
```

**Percentage (–ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ):**
```php
prize_type = 'percentage'
prize_percentage = 40    // 40% –æ—Ç –ø—Ä–∏–∑–æ–≤–æ–≥–æ —Ñ–æ–Ω–¥–∞
```

**Product (—Ç–æ–≤–∞—Ä–Ω—ã–µ):**
```php
prize_type = 'product'
prize_description = 'iPhone 15 Pro'  // –û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
```

#### 3. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–î–ª—è –ª–æ—Ç–µ—Ä–µ–π —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–∏–∑–æ–≤—ã—Ö –º–µ—Å—Ç (daily_dynamic, jackpot) –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:

```json
{
  "after_position": 3,              // –ü–æ—Å–ª–µ –∫–∞–∫–æ–π –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏–∫–∞
  "algorithm": "decreasing_percentage", // –ê–ª–≥–æ—Ä–∏—Ç–º —É–±—ã–≤–∞—é—â–∏—Ö –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
  "start_percentage": 25,           // –°—Ç–∞—Ä—Ç–æ–≤—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –º–µ—Å—Ç–∞
  "decrease_step": 3,               // –®–∞–≥ —É–º–µ–Ω—å—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–Ω—Ç–∞ (25%, 22%, 19%...)
  "min_amount_rub": 300,           // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –ø—Ä–∏–∑–∞ (—Å—Ç–æ–ø-—É—Å–ª–æ–≤–∏–µ)
  "base_fund_percentage": 20       // –ü—Ä–æ—Ü–µ–Ω—Ç —Ñ–æ–Ω–¥–∞ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
}
```

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

#### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
```php
$service = new LeaderBoardService($lotteryId);
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ª–æ—Ç–µ—Ä–µ—é —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø—Ä–∏–∑–æ–≤
```

#### 2. –†–∞—Å—á–µ—Ç –±–∞–∑–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤  
- –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ (—Ü–µ–Ω–∞ –±–∏–ª–µ—Ç–∞ √ó –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤)
- –ü—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥ (–≤—ã—Ä—É—á–∫–∞ √ó –ø—Ä–æ—Ü–µ–Ω—Ç –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)

#### 3. –†–∞—Å—á–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –î–µ–Ω–µ–∂–Ω—ã–µ –ø—Ä–∏–∑—ã: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞
- –ü—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ –ø—Ä–∏–∑—ã: —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç –ø—Ä–∏–∑–æ–≤–æ–≥–æ —Ñ–æ–Ω–¥–∞
- –¢–æ–≤–∞—Ä–Ω—ã–µ –ø—Ä–∏–∑—ã: —Å—É–º–º–∞ = 0 (–Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞—Å—á–µ—Ç—ã)

#### 4. –†–∞—Å—á–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –ø–æ–∑–∏—Ü–∏–π
- –í—ã–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–æ—Ü–µ–Ω—Ç —Ñ–æ–Ω–¥–∞ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Å—Ç–∞ —Å —É–±—ã–≤–∞—é—â–∏–º–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏
- –ê–ª–≥–æ—Ä–∏—Ç–º –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º—ã

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

#### Daily Fixed (1 –ø–æ–±–µ–¥–∏—Ç–µ–ª—å)
```php
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: 50% –æ—Ç –≤—ã—Ä—É—á–∫–∏ = –ø—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥
–ü–æ–∑–∏—Ü–∏—è 1: money, 1000 —Ä—É–± (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ)
```

#### Daily Dynamic (3 —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö + –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ)
```php
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: 50% –æ—Ç –≤—ã—Ä—É—á–∫–∏ = –ø—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥
–ü–æ–∑–∏—Ü–∏—è 1: percentage, 40% –æ—Ç —Ñ–æ–Ω–¥–∞
–ü–æ–∑–∏—Ü–∏—è 2: percentage, 25% –æ—Ç —Ñ–æ–Ω–¥–∞  
–ü–æ–∑–∏—Ü–∏—è 3: percentage, 15% –æ—Ç —Ñ–æ–Ω–¥–∞
–î–∏–Ω–∞–º–∏–∫–∞: 20% –æ—Å—Ç–∞—Ç–∫–∞ —Ñ–æ–Ω–¥–∞, —É–±—ã–≤–∞—é—â–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã –æ—Ç 25%
```

#### Supertour (10 —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Å—Ç)
```php
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: 50% –æ—Ç –≤—ã—Ä—É—á–∫–∏ = –ø—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥
–ü–æ–∑–∏—Ü–∏—è 1: money, 200000 —Ä—É–±
–ü–æ–∑–∏—Ü–∏—è 2: money, 100000 —Ä—É–±
–ü–æ–∑–∏—Ü–∏—è 4: product, "iPhone 15 Pro"
...–∏ —Ç–∞–∫ –¥–∞–ª–µ–µ
```

### API –º–µ—Ç–æ–¥—ã

#### getLeaderBoard()
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–∏–∑–∞—Ö:
```php
[
    'paid_tickets_count' => 145,     // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤
    'players_quantity' => 87,        // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
    'prize_fund' => 7250,           // –ü—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥ –≤ —Ä—É–±–ª—è—Ö
    'prize_details' => [            // –î–µ—Ç–∞–ª–∏ –ø—Ä–∏–∑–æ–≤—ã—Ö –º–µ—Å—Ç
        ['position' => 1, 'amount' => 2900],
        ['position' => 2, 'amount' => 1812],
        ['position' => 3, 'amount' => 1087],
        ['position' => 4, 'amount' => 362],
        ['position' => 5, 'amount' => 326],
        // ... –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –º–µ—Å—Ç–∞
    ]
]
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

- ‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–∑–æ–≤ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î, –ª–µ–≥–∫–æ –∏–∑–º–µ–Ω—è—é—Ç—Å—è
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ª—é–±–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–∏–ø–æ–≤ –ª–æ—Ç–µ—Ä–µ–π
- ‚úÖ **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** - –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –≤—Å–µ—Ö –ª–æ—Ç–µ—Ä–µ–π —Ç–∏–ø–∞
- ‚úÖ **–î–∏–Ω–∞–º–∏—á–Ω–æ—Å—Ç—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–∏–∑–æ–≤—ã—Ö –º–µ—Å—Ç
- ‚úÖ **–ê—É–¥–∏—Ç** - –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- ‚úÖ **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - —Å—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –ø—Ä–∏–∑–æ–≤ (–¥–µ–Ω—å–≥–∏/—Ç–æ–≤–∞—Ä—ã/–ø—Ä–æ—Ü–µ–Ω—Ç—ã)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–∑–æ–≤ —Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–∏–¥–µ—Ä—ã –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –≤ –ë–î:

```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –ø—Ä–∏–∑–æ–≤
docker exec -it ms-ticket-manager composer phinx-seed-up
```

### –ë–µ–∫–µ–Ω–¥ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏. –ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
